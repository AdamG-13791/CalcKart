                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ANSI-C Compiler
                                      3 ; Version 4.1.0 #12072 (MINGW64)
                                      4 ;--------------------------------------------------------
                                      5 	.module test
                                      6 	.optsdcc -mz80
                                      7 	
                                      8 ;--------------------------------------------------------
                                      9 ; Public variables in this module
                                     10 ;--------------------------------------------------------
                                     11 	.globl _test
                                     12 	.globl _speed
                                     13 	.globl _ang
                                     14 	.globl _yVel
                                     15 	.globl _xVel
                                     16 	.globl _yPos
                                     17 	.globl _xPos
                                     18 	.globl _inputKeys
                                     19 ;--------------------------------------------------------
                                     20 ; special function registers
                                     21 ;--------------------------------------------------------
                                     22 ;--------------------------------------------------------
                                     23 ; ram data
                                     24 ;--------------------------------------------------------
                                     25 	.area _DATA
      000000                         26 _inputKeys::
      000000                         27 	.ds 1
      000001                         28 _xPos::
      000001                         29 	.ds 2
      000003                         30 _yPos::
      000003                         31 	.ds 2
      000005                         32 _xVel::
      000005                         33 	.ds 2
      000007                         34 _yVel::
      000007                         35 	.ds 2
      000009                         36 _ang::
      000009                         37 	.ds 1
      00000A                         38 _speed::
      00000A                         39 	.ds 2
                                     40 ;--------------------------------------------------------
                                     41 ; ram data
                                     42 ;--------------------------------------------------------
                                     43 	.area _INITIALIZED
                                     44 ;--------------------------------------------------------
                                     45 ; absolute external ram data
                                     46 ;--------------------------------------------------------
                                     47 	.area _DABS (ABS)
                                     48 ;--------------------------------------------------------
                                     49 ; global & static initialisations
                                     50 ;--------------------------------------------------------
                                     51 	.area _HOME
                                     52 	.area _GSINIT
                                     53 	.area _GSFINAL
                                     54 	.area _GSINIT
                                     55 ;--------------------------------------------------------
                                     56 ; Home
                                     57 ;--------------------------------------------------------
                                     58 	.area _HOME
                                     59 	.area _HOME
                                     60 ;--------------------------------------------------------
                                     61 ; code
                                     62 ;--------------------------------------------------------
                                     63 	.area _CODE
                                     64 ;test.c:12: void test() {
                                     65 ;	---------------------------------
                                     66 ; Function test
                                     67 ; ---------------------------------
      000000                         68 _test::
      000000 CDr00r00         [17]   69 	call	___sdcc_enter_ix
      000003 F5               [11]   70 	push	af
      000004 F5               [11]   71 	push	af
                                     72 ;test.c:18: __endasm;
      000005 ED 5Br01r00      [20]   73 	ld	de, (_xPos)
      000009 2Ar03r00         [16]   74 	ld	hl, (_yPos)
      00000C CDr00r00         [17]   75 	call	getDist
      00000F 22r0Ar00         [16]   76 	ld	(_speed), hl
                                     77 ;test.c:19: char curKeys = inputKeys;
      000012 3Ar00r00         [13]   78 	ld	a,(#_inputKeys + 0)
                                     79 ;test.c:20: curKeys <<= 2;
      000015 87               [ 4]   80 	add	a, a
      000016 87               [ 4]   81 	add	a, a
                                     82 ;test.c:21: if ((curKeys & 1) == 1) {
      000017 DD 77 FC         [19]   83 	ld	-4 (ix), a
      00001A E6 01            [ 7]   84 	and	a, #0x01
      00001C 5F               [ 4]   85 	ld	e, a
      00001D 16 00            [ 7]   86 	ld	d, #0x00
                                     87 ;test.c:22: ang -= speed / 4;
      00001F 2Ar0Ar00         [16]   88 	ld	hl, (_speed)
      000022 DD 75 FD         [19]   89 	ld	-3 (ix), l
      000025 DD 74 FE         [19]   90 	ld	-2 (ix), h
      000028 7C               [ 4]   91 	ld	a, h
      000029 07               [ 4]   92 	rlca
      00002A E6 01            [ 7]   93 	and	a,#0x01
      00002C DD 77 FF         [19]   94 	ld	-1 (ix), a
      00002F DD 4E FD         [19]   95 	ld	c, -3 (ix)
      000032 DD 46 FE         [19]   96 	ld	b, -2 (ix)
      000035 03               [ 6]   97 	inc	bc
      000036 03               [ 6]   98 	inc	bc
      000037 03               [ 6]   99 	inc	bc
                                    100 ;test.c:21: if ((curKeys & 1) == 1) {
      000038 7B               [ 4]  101 	ld	a, e
      000039 3D               [ 4]  102 	dec	a
      00003A B2               [ 4]  103 	or	a, d
      00003B 20 1E            [12]  104 	jr	NZ, 00102$
                                    105 ;test.c:22: ang -= speed / 4;
      00003D DD 5E FD         [19]  106 	ld	e, -3 (ix)
      000040 DD 56 FE         [19]  107 	ld	d, -2 (ix)
      000043 DD 7E FF         [19]  108 	ld	a, -1 (ix)
      000046 B7               [ 4]  109 	or	a, a
      000047 28 02            [12]  110 	jr	Z, 00107$
      000049 59               [ 4]  111 	ld	e, c
      00004A 50               [ 4]  112 	ld	d, b
      00004B                        113 00107$:
      00004B CB 2A            [ 8]  114 	sra	d
      00004D CB 1B            [ 8]  115 	rr	e
      00004F CB 2A            [ 8]  116 	sra	d
      000051 CB 1B            [ 8]  117 	rr	e
      000053 3Ar09r00         [13]  118 	ld	a,(#_ang + 0)
      000056 21r09r00         [10]  119 	ld	hl, #_ang
      000059 93               [ 4]  120 	sub	a, e
      00005A 77               [ 7]  121 	ld	(hl), a
      00005B                        122 00102$:
                                    123 ;test.c:24: curKeys <<= 1;
      00005B DD 7E FC         [19]  124 	ld	a, -4 (ix)
      00005E 87               [ 4]  125 	add	a, a
                                    126 ;test.c:25: if ((curKeys & 1) == 1) {
      00005F E6 01            [ 7]  127 	and	a, #0x01
      000061 57               [ 4]  128 	ld	d, a
      000062 1E 00            [ 7]  129 	ld	e, #0x00
      000064 7A               [ 4]  130 	ld	a, d
      000065 3D               [ 4]  131 	dec	a
      000066 B3               [ 4]  132 	or	a, e
      000067 20 1D            [12]  133 	jr	NZ, 00105$
                                    134 ;test.c:26: ang += speed / 4;
      000069 DD 5E FD         [19]  135 	ld	e, -3 (ix)
      00006C DD 56 FE         [19]  136 	ld	d, -2 (ix)
      00006F DD 7E FF         [19]  137 	ld	a, -1 (ix)
      000072 B7               [ 4]  138 	or	a, a
      000073 28 02            [12]  139 	jr	Z, 00108$
      000075 59               [ 4]  140 	ld	e, c
      000076 50               [ 4]  141 	ld	d, b
      000077                        142 00108$:
      000077 CB 2A            [ 8]  143 	sra	d
      000079 CB 1B            [ 8]  144 	rr	e
      00007B CB 2A            [ 8]  145 	sra	d
      00007D CB 1B            [ 8]  146 	rr	e
      00007F 3Ar09r00         [13]  147 	ld	a,(#_ang + 0)
      000082 83               [ 4]  148 	add	a, e
      000083 32r09r00         [13]  149 	ld	(_ang+0), a
      000086                        150 00105$:
                                    151 ;test.c:28: }
      000086 DD F9            [10]  152 	ld	sp, ix
      000088 DD E1            [14]  153 	pop	ix
      00008A C9               [10]  154 	ret
                                    155 	.area _CODE
                                    156 	.area _INITIALIZER
                                    157 	.area _CABS (ABS)
